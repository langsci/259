%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%                                              %%%
%%%     Language Science Press Master File       %%%
%%%         follow the instructions below        %%%
%%%                                              %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 
% Everything following a % is ignored
% Some lines start with %. Remove the % to include them

\documentclass[output=book
		,modfonts
		,nonflat
	        ,collection
	        ,collectionchapter
	        ,collectiontoclongg
 	        ,biblatex  
                ,babelshorthands
                ,newtxmath
%                ,colorlinks, citecolor=brown % for drafts
%                ,draftmode
% 	        ,coverus
		  ]{./langsci/langscibook}                              
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% put all additional commands you need in the 
% following files. If you do not know what this might 
% mean, you can safely ignore this section


\input{localmetadata.tex}
\input{localpackages.tex}
\input{localhyphenation.tex}

% \lsYear does not work, so I hardcoded the year as 2019

\patchcmd{\includepaper}{\immediate\write\tempfile{@incollection{#1footer,author={\authorTemp},title={{\lsCollectionPaperFooterTitle}},booktitle={{\lsCollectionTitle}},editor={\editorTemp},publisher={Language Science Press.},Address={Berlin},year={\lsYear},pages={\lsCollectionPaperFirstPage--\lsCollectionPaperLastPage},doi={\lsChapterDOI},options={dataonly=true}}}}{\immediate\write\tempfile{@incollection{#1footer,author={\authorTemp},title={{\lsCollectionPaperFooterTitle}},booktitle={{\lsCollectionTitle}},editor={\editorTemp},publisher={Language Science Press.},Address={Berlin},pubstate={2019},note={Prepublished version},addendum={[Preliminary page numbering]},options={dataonly=true}}}}



\input{localcommands.tex} 

% fix, remove once forest is updated
% should work with texlive 2017
%% \makeatletter
%% \apptocmd\forest@pgfmathhelper@attribute@dimen{\global\pgfmathunitsdeclaredtrue}{\typeout{patching succeeded}}{patching failed}
%% \apptocmd\forest@pgfmathhelper@register@dimen{\global\pgfmathunitsdeclaredtrue}{\typeout{patching succeeded}}{patching failed}
%% \makeatother 


\input{bibliographies-include}

\usepackage{xassoccnt}
\newcounter{realpage}
\DeclareAssociatedCounters{page}{realpage}
\AtBeginDocument{%
  \stepcounter{realpage}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%                                              %%%
%%%             Frontmatter                      %%%
%%%                                              %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}         
\maketitle                
\frontmatter
% %% uncomment if you have preface and/or acknowledgements

\currentpdfbookmark{Contents}{name} % adds a PDF bookmark
\tableofcontents
\include{chapters/preface}
\include{chapters/acknowledgments}

%% Additional prefaces and/or introductions that also have authors
%\lsCollectionPaperFrontmatterMode % Enter the Frontmatter Mode. 
%\includepaper{chapters/prefaceEd}
% \includepaper{chapters/prefaceEd2}
\lsCollectionPaperMainmatterMode % Leave the Frontmatter Mode 
\setcounter{chapter}{0} % Reset the chapter counter so that preceeding prefaces are not counted
%%
\mainmatter          
\typeout{mainmatter starts at \therealpage}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%                                              %%%
%%%             Chapters                         %%%
%%%                                              %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 
\part{Introduction}  
\pagenumbering{roman}\counterwithin*{page}{chapter}%

\includepaper{chapters/properties} %add a percentage sign in front of the line to exclude this chapter from book
\includepaper{chapters/evolution} 
\includepaper{chapters/formal-background}
\includepaper{chapters/lexicon}
\includepaper{chapters/understudied-languages}
% 
\part{Syntactic phenomena}

\includepaper{chapters/agreement}
\includepaper{chapters/case}
\includepaper{chapters/np}
\includepaper{chapters/arg-st}
\includepaper{chapters/order}
\includepaper{chapters/clitics}
\includepaper{chapters/complex-predicates}
\includepaper{chapters/control-raising}
\includepaper{chapters/udc}
\includepaper{chapters/relative-clauses}
\includepaper{chapters/islands}
\includepaper{chapters/coordination}
\includepaper{chapters/idioms}
\includepaper{chapters/negation}
\includepaper{chapters/ellipsis}
%\includepaper{chapters/binding}
%
\part{Other levels of description}

\includepaper{chapters/phonology}
\includepaper{chapters/morphology}
\includepaper{chapters/semantics}
\includepaper{chapters/information-structure}
%
\part{Other areas of linguistics}
\includepaper{chapters/diachronic}
\includepaper{chapters/acquisition}
\includepaper{chapters/processing}
\includepaper{chapters/cl}
\includepaper{chapters/pragmatics}
\includepaper{chapters/sign-lg}
\includepaper{chapters/gesture}
%
\part{The broader picture}
\includepaper{chapters/minimalism}
\includepaper{chapters/cg}
\includepaper{chapters/lfg}
\includepaper{chapters/dg}
\includepaper{chapters/cxg}
%
% copy the lines above and adapt as necessary

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%                                              %%%
%%%             Backmatter                       %%%
%%%                                              %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% There is normally no need to change the backmatter section
\input{backmatter.tex}

\end{document} 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%                                              %%%
%%%                  END                         %%%
%%%                                              %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% you can create your book by running
% xelatex main.tex
%
% you can also try a simple 
% make
% on the commandline
